# Полный список тестов для проверки работоспособности бота

## 1. Основные сценарии работы с розыгрышами

### 1.1 Создание розыгрыша
- Успешное создание розыгрыша с минимальными параметрами
- Создание розыгрыша с медиафайлами
- Создание розыгрыша с требованиями подписки
- Создание розыгрыша с реферальной системой
- Создание розыгрыша с CAPTCHA
- Создание розыгрыша с несколькими победителями

### 1.2 Управление розыгрышем (владельцем)
- Просмотр хаба розыгрышей
- Просмотр списка активных розыгрышей
- Просмотр списка завершенных розыгрышей
- Управление конкретным розыгрышем
- Повторная публикация розыгрыша
- Принудительное завершение розыгрыша
- Удаление розыгрыша
- Просмотр статистики розыгрыша

### 1.3 Участие в розыгрыше
- Успешное участие в розыгрыше
- Повторное участие в одном розыгрыше
- Участие в завершенном розыгрыше
- Участие в чужом розыгрыше (успешно)
- Участие с обязательной подпиской
- Получение билета участника
- Увеличение билетов за рефералов

## 2. Сценарии с ошибками пользователей (20 вариантов)

### 2.1 Ошибки при создании розыгрыша
1. **Попытка создать розыгрыш с пустым названием приза**
   - Пользователь вводит пустую строку в качестве названия приза
   - Ожидаемый результат: сообщение об ошибке, запрос повторного ввода

2. **Создание розыгрыша с отрицательным числом победителей**
   - Пользователь указывает отрицательное число победителей
   - Ожидаемый результат: валидация, сообщение об ошибке

3. **Попытка создать розыгрыш с датой в прошлом**
   - Пользователь указывает дату окончания в прошлом
   - Ожидаемый результат: сообщение об ошибке, запрос корректной даты

4. **Создание розыгрыша с чрезмерно длинным описанием**
   - Пользователь вводит текст приза длиной >1000 символов
   - Ожидаемый результат: обрезка текста или сообщение об ошибке

5. **Попытка создать розыгрыш с недоступным каналом**
   - Пользователь указывает ID канала, к которому нет доступа
   - Ожидаемый результат: сообщение об ошибке доступа

### 2.2 Ошибки при управлении розыгрышем
6. **Попытка доступа к чужому розыгрышу**
   - Пользователь пытается управлять розыгрышем другого пользователя
   - Ожидаемый результат: сообщение об отсутствии прав доступа

7. **Повторное завершение уже завершенного розыгрыша**
   - Пользователь пытается завершить уже завершенный розыгрыш
   - Ожидаемый результат: сообщение о том, что розыгрыш уже завершен

8. **Удаление несуществующего розыгрыша**
   - Пользователь пытается удалить розыгрыш с несуществующим ID
   - Ожидаемый результат: сообщение об отсутствии розыгрыша

9. **Повторная публикация завершенного розыгрыша**
   - Пользователь пытается опубликовать завершенный розыгрыш
   - Ожидаемый результат: сообщение о невозможности действия

10. **Попытка удалить розыгрыш другого пользователя**
   - Пользователь пытается удалить чужой розыгрыш
   - Ожидаемый результат: сообщение об отсутствии прав доступа

### 2.3 Ошибки при участии в розыгрыше
11. **Попытка участия в собственном розыгрыше**
   - Владелец розыгрыша пытается в него записаться
   - Ожидаемый результат: сообщение о невозможности участия

12. **Попытка участия в завершенном розыгрыше**
   - Пользователь пытается участвовать в уже завершенном розыгрыше
   - Ожидаемый результат: сообщение о завершении розыгрыша

13. **Несоблюдение условий подписки**
   - Пользователь не подписался на требуемые каналы
   - Ожидаемый результат: сообщение о необходимости подписки

14. **Повторное участие в одном и том же розыгрыше**
   - Пользователь пытается снова участвовать в розыгрыше
   - Ожидаемый результат: сообщение о том, что уже участвует

15. **Непрохождение CAPTCHA**
   - Пользователь не проходит проверку на бота
   - Ожидаемый результат: блокировка участия до прохождения проверки

### 2.4 Ошибки с реферальной системой
16. **Использование своей собственной реф. ссылки**
   - Пользователь переходит по своей же реф. ссылке
   - Ожидаемый результат: реферал не засчитывается

17. **Циклическая реферальная цепочка**
   - Пользователь A приглашает B, B приглашает A
   - Ожидаемый результат: реферал не засчитывается

18. **Использование реф. ссылки несуществующего пользователя**
   - Пользователь использует ссылку с несуществующим ID
   - Ожидаемый результат: ссылка игнорируется

19. **Использование реф. ссылки после выхода из розыгрыша**
   - Пользователь использует ссылку человека, который вышел из розыгрыша
   - Ожидаемый результат: реферал не засчитывается

20. **Подписка на каналы с недоступными ссылками**
   - Один из каналов-спонсоров имеет недоступную ссылку
   - Ожидаемый результат: возможность участия без подписки на этот канал

## 3. Сценарии нагрузочного тестирования

### 3.1 Множественное участие
- Одновременное участие большого числа пользователей
- Проверка корректности генерации билетов
- Проверка производительности при большом числе участников

### 3.2 Множественные действия
- Одновременное создание нескольких розыгрышей
- Параллельное управление розыгрышами
- Проверка корректности работы транзакций

## 4. Сценарии безопасности

### 4.1 Защита от SQL-инъекций
- Проверка валидации входных данных
- Использование параметризованных запросов
- Проверка обработки специальных символов

### 4.2 Защита от XSS
- Проверка экранирования HTML в текстах
- Обработка специальных символов в названиях призов
- Проверка корректной работы с юникодом

### 4.3 Защита от CSRF
- Проверка корректности обработки callback-данных
- Валидация источника запросов
- Проверка соответствия сессии пользователю

## 5. Сценарии восстановления после ошибок

### 5.1 Восстановление после сбоев
- Восстановление после ошибки базы данных
- Восстановление после сбоя сети
- Восстановление после аварийного завершения работы

### 5.2 Обработка исключений
- Обработка ошибок API Telegram
- Обработка таймаутов соединения
- Обработка ошибок доступа к каналам