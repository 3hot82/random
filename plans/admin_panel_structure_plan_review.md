# ะะตะฒัั ะฟะปะฐะฝะฐ admin_panel_structure_plan.md

## ะะฒะตะดะตะฝะธะต

ะะพัะปะต ะธะทััะตะฝะธั ะบะพะดะฐ ะฟัะพะตะบัะฐ ะธ ะฐะฝะฐะปะธะทะฐ ัะฐะนะปะฐ `admin_panel_structure_plan.md`, ะฟะพะดะณะพัะพะฒะปะตะฝะพ ัะตะฒัั ั ัะตะบะพะผะตะฝะดะฐัะธัะผะธ ะฟะพ ัะปัััะตะฝะธั ััััะบัััั ะฐะดะผะธะฝ-ะฟะฐะฝะตะปะธ. ะ ััะพะผ ัะตะฒัั ัะฐััะผะฐััะธะฒะฐัััั ะพัะฝะพะฒะฝัะต ะฟัะพะฑะปะตะผั ัะตะบััะตะน ัะตะฐะปะธะทะฐัะธะธ ะธ ะฟัะตะดะปะฐะณะฐะตััั ัะปัััะตะฝะฝะฐั ะฐััะธัะตะบัััะฐ ะดะปั ะฟะพะฒััะตะฝะธั ัะดะพะฑััะฒะฐ ะธัะฟะพะปัะทะพะฒะฐะฝะธั ะธ ัััะตะบัะธะฒะฝะพััะธ ะฐะดะผะธะฝะธัััะธัะพะฒะฐะฝะธั.

## ะะฑัะฐั ะพัะตะฝะบะฐ ัะตะบััะตะน ัะธััะฐัะธะธ

ะ ะฟัะพะตะบัะต ัะถะต ัะตะฐะปะธะทะพะฒะฐะฝะฐ ะฑะฐะทะพะฒะฐั ััััะบัััะฐ ะฐะดะผะธะฝ-ะฟะฐะฝะตะปะธ ั ะดะตัะตะฒะพะผ ะบะฝะพะฟะพะบ ะดะปั ัะฐะทะดะตะปะฐ ััะฐัะธััะธะบะธ. ะกััะตััะฒัะตั ะธะตัะฐััะธัะตัะบะพะต ะผะตะฝั ั ะฝะฐะฒะธะณะฐัะธะตะน ะธ ัะพะพัะฒะตัััะฒัััะธะต ะพะฑัะฐะฑะพััะธะบะธ. ะะดะฝะฐะบะพ ัะตะบััะฐั ัะตะฐะปะธะทะฐัะธั ะธะผะตะตั ััะด ะพะณัะฐะฝะธัะตะฝะธะน ะฒ ะพะฑะปะฐััะธ UX ะธ ะฝะฐะฒะธะณะฐัะธะธ, ะบะพัะพััะต ะผะตัะฐัั ัััะตะบัะธะฒะฝะพะผั ะฐะดะผะธะฝะธัััะธัะพะฒะฐะฝะธั.

## ะัะฝะพะฒะฝัะต ะฟัะพะฑะปะตะผั ัะตะบััะตะน ะฝะฐะฒะธะณะฐัะธะธ ะธ ะดะตัะตะฒะฐ ะบะฝะพะฟะพะบ

### 1. ะะตะดะพััะฐัะพัะฝะฐั ะณะธะฑะบะพััั ะฝะฐะฒะธะณะฐัะธะธ

- **ะััััััะฒะธะต "ัะปะตะฑะฝัั ะบัะพัะตะบ"**: ะะพะปัะทะพะฒะฐัะตะปะธ ัะตัััั ะบะพะฝัะตะบัั ะฟัะธ ะณะปัะฑะพะบะพะน ะฝะฐะฒะธะณะฐัะธะธ ะฟะพ ะผะตะฝั
- **ะะณัะฐะฝะธัะตะฝะฝัะต ะฒะพะทะผะพะถะฝะพััะธ ะฒะพะทะฒัะฐัะฐ**: ะะฝะพะฟะบะฐ "ะะฐะทะฐะด" ะฒัะตะณะดะฐ ะฒะพะทะฒัะฐัะฐะตั ัะพะปัะบะพ ะฝะฐ ะพะดะธะฝ ััะพะฒะตะฝั
- **ะะตั ะฑััััะพะณะพ ะดะพัััะฟะฐ ะบ ะณะปะฐะฒะฝะพะผั ะผะตะฝั**: ะะปั ะฒะพะทะฒัะฐัะฐ ะฒ ะณะปะฐะฒะฝะพะต ะผะตะฝั ััะตะฑัะตััั ะฝะตัะบะพะปัะบะพ ัะฐะณะพะฒ

### 2. ะัะพะฑะปะตะผั ั UX ะฟัะธ ัะฟัะฐะฒะปะตะฝะธะธ ะฟะพะปัะทะพะฒะฐัะตะปัะผะธ

- **ะััััััะฒะธะต ัะฟะธัะบะฐ ะฟะพะปัะทะพะฒะฐัะตะปะตะน ะฒ ะฒะธะดะต ะธะฝะปะฐะนะฝ-ะบะฝะพะฟะพะบ**: ะขะตะบััะฐั ัะตะฐะปะธะทะฐัะธั ะฟะพะบะฐะทัะฒะฐะตั ัะพะปัะบะพ ัะตะบััะพะฒัะน ัะฟะธัะพะบ
- **ะะตะดะพััะฐัะพัะฝะพ ะฒะพะทะผะพะถะฝะพััะตะน ัะธะปัััะฐัะธะธ ะธ ะฟะพะธัะบะฐ**: ะััััััะฒัะตั ะฟัะพะดะฒะธะฝััะฐั ะฝะฐะฒะธะณะฐัะธั ะฟะพ ะฟะพะปัะทะพะฒะฐัะตะปัะผ
- **ะะตั ะฒะธะทัะฐะปัะฝะพะณะพ ะฟะพะดัะฒะตัะถะดะตะฝะธั ะดะตะนััะฒะธะน**: ะะพะปัะทะพะฒะฐัะตะปั ะฝะต ะฒะธะดะธั ัะตะทัะปััะฐั ะฒัะฟะพะปะฝะตะฝะฝะพะณะพ ะดะตะนััะฒะธั ะดะพ ะพะฑะฝะพะฒะปะตะฝะธั ัััะฐะฝะธัั

### 3. ะัะพะฑะปะตะผั ั ะฟะฐะณะธะฝะฐัะธะตะน

- **ะััััััะฒะธะต ะฟะพะปะฝะพัะตะฝะฝะพะน ะฟะฐะณะธะฝะฐัะธะธ ะฒ ัะตะบััะตะผ ะบะพะดะต**: ะฅะพัั ะฒ ะฟะปะฐะฝะต ะฟัะตะดััะผะพััะตะฝะฐ ะฟะฐะณะธะฝะฐัะธั, ะฒ ัะตะบััะตะน ัะตะฐะปะธะทะฐัะธะธ ะพะฝะฐ ะฝะต ะฟะพะปะฝะพัััั ััะฝะบัะธะพะฝะฐะปัะฝะฐ
- **ะะตั ะธะฝะดะธะบะฐัะพัะพะฒ ัะตะบััะตะน ัััะฐะฝะธัั ะธ ะพะฑัะตะณะพ ะบะพะปะธัะตััะฒะฐ**: ะะพะปัะทะพะฒะฐัะตะปั ะฝะต ะทะฝะฐะตั, ะณะดะต ะพะฝ ะฝะฐัะพะดะธััั ะฒ ัะฟะธัะบะต

### 4. ะะตะดะพััะฐัะบะธ ะฒ ัะธััะตะผะต ัะฟัะฐะฒะปะตะฝะธั ัะพะทัะณัััะฐะผะธ

- **ะะณัะฐะฝะธัะตะฝะฝัะต ะฒะพะทะผะพะถะฝะพััะธ ะผะฐััะพะฒะพะณะพ ัะฟัะฐะฒะปะตะฝะธั**: ะะตั ะฒะพะทะผะพะถะฝะพััะธ ะฒัะฟะพะปะฝััั ะดะตะนััะฒะธั ั ะฝะตัะบะพะปัะบะธะผะธ ัะพะทัะณัััะฐะผะธ ะพะดะฝะพะฒัะตะผะตะฝะฝะพ
- **ะะตะดะพััะฐัะพัะฝะฐั ะดะตัะฐะปะธะทะฐัะธั ะธะฝัะพัะผะฐัะธะธ ะพ ัะพะทัะณัััะฐั**: ะััััััะฒัะตั ะฒะฐะถะฝะฐั ััะฐัะธััะธะบะฐ ะฒ ัะฟะธัะบะต ัะพะทัะณัััะตะน

## ะะตะบะพะผะตะฝะดะฐัะธะธ ะฟะพ ัะปัััะตะฝะธั ะฝะฐะฒะธะณะฐัะธะธ ะธ UX

### 1. ะฃะปัััะตะฝะธะต ัะธััะตะผั ะฝะฐะฒะธะณะฐัะธะธ

#### ะฅะปะตะฑะฝัะต ะบัะพัะบะธ (Breadcrumb navigation)
ะะพะฑะฐะฒะธัั ัััะพะบั ะฝะฐะฒะธะณะฐัะธะธ ะฒ ะฝะฐัะฐะปะต ะบะฐะถะดะพะณะพ ัะพะพะฑัะตะฝะธั ะฐะดะผะธะฝ-ะฟะฐะฝะตะปะธ:

```
๐ ะะดะผะธะฝ-ะฟะฐะฝะตะปั > ๐ฅ ะะพะปัะทะพะฒะฐัะตะปะธ > ๐ ะะพะธัะบ
```

#### ะฃะปัััะตะฝะฝัะต ะบะฝะพะฟะบะธ ะฝะฐะฒะธะณะฐัะธะธ
ะะผะตััะพ ะฟัะพััะพะน ะบะฝะพะฟะบะธ "ะะฐะทะฐะด", ะฟัะตะดะพััะฐะฒะธัั ะฟะพะปัะทะพะฒะฐัะตะปั ะฒัะฑะพั:

```
[๐ ะะปะฐะฒะฝะพะต ะผะตะฝั] [๐ ะะฐะทะฐะด] [โก๏ธ ะะฟะตัะตะด (ะตัะปะธ ะฟัะธะผะตะฝะธะผะพ)]
```

#### ะะพะฝัะตะบััะฝะพ-ะทะฐะฒะธัะธะผัะต ะบะฝะพะฟะบะธ
ะะฝะพะฟะบะฐ "ะะฐะทะฐะด" ะดะพะปะถะฝะฐ ััะธััะฒะฐัั ัะตะบััะตะต ะผะตััะพะฟะพะปะพะถะตะฝะธะต ะฟะพะปัะทะพะฒะฐัะตะปั ะฒ ะธะตัะฐััะธะธ ะผะตะฝั ะธ ะฒะพะทะฒัะฐัะฐัั ะตะณะพ ะบ ะปะพะณะธัะตัะบะธ ัะฒัะทะฐะฝะฝะพะผั ัะฐะทะดะตะปั.

### 2. ะฃะปัััะตะฝะธะต UX ะดะปั ัะฟัะฐะฒะปะตะฝะธั ะฟะพะปัะทะพะฒะฐัะตะปัะผะธ

#### ะะฝะปะฐะนะฝ-ะบะฝะพะฟะบะธ ะดะปั ัะฟะธัะบะฐ ะฟะพะปัะทะพะฒะฐัะตะปะตะน
ะะผะตััะพ ัะตะบััะพะฒะพะณะพ ัะฟะธัะบะฐ, ะฟะพะบะฐะทัะฒะฐัั ะฟะพะปัะทะพะฒะฐัะตะปะตะน ะฒ ะฒะธะดะต ะธะฝะปะฐะนะฝ-ะบะฝะพะฟะพะบ ั ะฒะพะทะผะพะถะฝะพัััั ะฒัะฑะพัะฐ:

```
โโโโโโโโโโโโโโโโโโโ โโโโโโโโโโโโโโโโโโโ
โ ๐ค ะะฒะฐะฝ ะะฒะฐะฝะพะฒ   โ โ ๐ค ะะตััะพะฒ   โ
โ ID: 123456789   โ โ ID: 987654321   โ
โโโโโโโโโโโโโโโโโโโ โโโโโโโโโโโโโโโโโโโ
โโโโโโโโโโโโโโโโโโโ โโโโโโโโโโโโโโโโโโโ
โ ๐ค ะกะธะดะพัะพะฒ ะก.   โ โ ๐ค ะะพะทะปะพะฒะฐ ะ.   โ
โ ID: 11222333   โ โ ID: 444555666   โ
โโโโโโโโโโโโโโโโโโโ โโโโโโโโโโโโโโโโโโโ
```

#### ะะฐััะธัะตะฝะฝัะต ะฒะพะทะผะพะถะฝะพััะธ ัะฟัะฐะฒะปะตะฝะธั
ะัะธ ะฒัะฑะพัะต ะฟะพะปัะทะพะฒะฐัะตะปั ะฟะพะบะฐะทัะฒะฐัั ะบะฐััะพัะบั ั ะฟะพะดัะพะฑะฝะพะน ะธะฝัะพัะผะฐัะธะตะน ะธ ะดะตะนััะฒะธัะผะธ:

```
๐ค ะัะฑัะฐะฝ: @username (ID: 12345)
โโโ โญ ะัะดะฐัั ะฟัะตะผะธัะผ
โโโ ๐ซ ะกะฝััั ะฟัะตะผะธัะผ  
โโโ ๐ ะะฐะฑะปะพะบะธัะพะฒะฐัั
โโโ โ ะะฐะทะฑะปะพะบะธัะพะฒะฐัั
โโโ ๐ ะกัะฐัะธััะธะบะฐ ะฟะพะปัะทะพะฒะฐัะตะปั
โโโ ๐ ะะฐะทะฐะด
```

### 3. ะฃะปัััะตะฝะฝะฐั ะฟะฐะณะธะฝะฐัะธั

#### ะะฝัะตัะฐะบัะธะฒะฝัะต ัะปะตะผะตะฝัั ะฟะฐะณะธะฝะฐัะธะธ
ะะตะฐะปะธะทะพะฒะฐัั ะฟะพะปะฝะพััะฝะบัะธะพะฝะฐะปัะฝัะต ะบะฝะพะฟะบะธ ะฟะฐะณะธะฝะฐัะธะธ:

```
[<<] [<] 1 2 3 ... 15 [>] [>>] [1/15]
```

#### ะะฝะดะธะบะฐัะพัั ัะพััะพัะฝะธั
ะะพะบะฐะทัะฒะฐัั ัะตะบัััั ัััะฐะฝะธัั ะธ ะพะฑัะตะต ะบะพะปะธัะตััะฒะพ:

```
ะกััะฐะฝะธัะฐ 3 ะธะท 15 (ะัะตะณะพ: 147 ะฟะพะปัะทะพะฒะฐัะตะปะตะน)
```

### 4. ะฃะปัััะตะฝะธั ะดะปั ัะฐะทะดะตะปะฐ ัะพะทัะณัััะตะน

#### ะฃะปัััะตะฝะฝัะน ัะฟะธัะพะบ ัะพะทัะณัััะตะน
ะะพะฑะฐะฒะธัั ะฒะธะทัะฐะปัะฝัะต ะธะฝะดะธะบะฐัะพัั ััะฐัััะฐ ะธ ะบะปััะตะฒัะต ะผะตััะธะบะธ:

```
๐ข #123 ะะพะทัะณััั iPhone | ะฃัะฐััะฝะธะบะพะฒ: 1245 | ะะปะฐะดะตะปะตั: 123456789
๐ด #122 ะะฐะฒะตััะตะฝะฝัะน ัะพะทัะณััั | ะะพะฑะตะดะธัะตะปั: 987654321 | 15.01.2026
๐ก #121 ะะถะธะดะฐะตั ะทะฐะฒะตััะตะฝะธั | ะฃัะฐััะฝะธะบะพะฒ: 890 | ะะพ ะพะบะพะฝัะฐะฝะธั: 2ะด 5ั
```

#### ะะฐััะพะฒัะต ะดะตะนััะฒะธั
ะะพะฑะฐะฒะธัั ะฒะพะทะผะพะถะฝะพััั ะฒัะฟะพะปะฝะตะฝะธั ะดะตะนััะฒะธะน ั ะฝะตัะบะพะปัะบะธะผะธ ัะพะทัะณัััะฐะผะธ:

```
ะัะฑะตัะธัะต ัะพะทัะณัััะธ ะดะปั ะผะฐััะพะฒะพะณะพ ะดะตะนััะฒะธั:
[ ] #123 | [X] #122 | [X] #121 | [ ] #120
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ะะตะนััะฒะธั: [ะะฐะฒะตััะธัั ะฒัะฑัะฐะฝะฝัะต] [ะฃะดะฐะปะธัั ะฒัะฑัะฐะฝะฝัะต] [ะญะบัะฟะพัั]
```

## ะะตะบะพะผะตะฝะดะฐัะธะธ ะฟะพ ะบะฝะพะฟะบะฐะผ "ะฝะฐะทะฐะด" ะธ ัะปัััะตะฝะธั UX

### 1. ะฃะฝะธะฒะตััะฐะปัะฝะฐั ัะธััะตะผะฐ ะฝะฐะฒะธะณะฐัะธะธ

ะะตะบะพะผะตะฝะดัะตััั ะฒะฝะตะดัะธัั ัะฝะธะฒะตััะฐะปัะฝัะน ะผะตัะฐะฝะธะทะผ ะฝะฐะฒะธะณะฐัะธะธ ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ ัะฟะตัะธะฐะปัะฝะพะน callback data:

```python
class NavigationAction(CallbackData, prefix="nav"):
    action: str  # "back", "main", "previous_section", "custom"
    section: str = ""  # ัะตะปะตะฒะพะน ัะฐะทะดะตะป ะดะปั "custom"
    context: str = ""  # ะบะพะฝัะตะบัั ัะตะบััะตะณะพ ะฟะพะปะพะถะตะฝะธั
```

### 2. ะะพะฝัะตะบััะฝะพ-ะทะฐะฒะธัะธะผัะน ะฒะพะทะฒัะฐั

ะะผะตััะพ ัะฝะธะฒะตััะฐะปัะฝะพะน ะบะฝะพะฟะบะธ "ะะฐะทะฐะด", ะธัะฟะพะปัะทะพะฒะฐัั ัะธััะตะผั, ะบะพัะพัะฐั ะทะฐะฟะพะผะธะฝะฐะตั ะฟััั ะฟะพะปัะทะพะฒะฐัะตะปั ะธ ะฟะพะทะฒะพะปัะตั ะฒะพะทะฒัะฐัะฐัััั ะบ ะปะพะณะธัะตัะบะธ ัะฒัะทะฐะฝะฝะพะผั ัะฐะทะดะตะปั:

```python
# ะัะธ ะฒัะพะดะต ะฒ ัะฐะทะดะตะป ัะพััะฐะฝัะตะผ ะฟัะตะดัะดััะธะน ะบะพะฝัะตะบัั
await state.update_data(previous_context="users_list")

# ะัะธ ะฝะฐะถะฐัะธะธ "ะะฐะทะฐะด" ะฒะพะทะฒัะฐัะฐะตะผัั ะบ ัะพััะฐะฝะตะฝะฝะพะผั ะบะพะฝัะตะบััั
@router.callback_query(NavigationAction.filter(F.action == "back"))
async def navigate_back(call: CallbackQuery, state: FSMContext):
    data = await state.get_data()
    previous_context = data.get("previous_context", "main")
    
    if previous_context == "users_list":
        await show_users_list(call, ...)
    elif previous_context == "giveaways_list":
        await show_giveaways_list(call, ...)
    # ะธ ั.ะด.
```

### 3. ะฃะปัััะตะฝะฝัะต ะธะฝะปะฐะนะฝ-ะบะฝะพะฟะบะธ ะดะปั ะดะตะนััะฒะธะน

ะะปั ัะฐะทะดะตะปะฐ ัะฟัะฐะฒะปะตะฝะธั ะฟะพะปัะทะพะฒะฐัะตะปัะผะธ ัะตะบะพะผะตะฝะดัะตััั ัะตะฐะปะธะทะพะฒะฐัั ะบะฐััะพัะบะธ ะฟะพะปัะทะพะฒะฐัะตะปะตะน ั ะดะตะนััะฒะธัะผะธ:

```python
def create_user_management_buttons(user_id: int, is_super_admin: bool = False):
    kb = InlineKeyboardBuilder()
    
    # ะัะฝะพะฒะฝัะต ะดะตะนััะฒะธั
    kb.button(text="โญ ะัะดะฐัั ะฟัะตะผะธัะผ", callback_data=UsersAction(action="grant_premium", user_id=user_id))
    kb.button(text="๐ซ ะกะฝััั ะฟัะตะผะธัะผ", callback_data=UsersAction(action="revoke_premium", user_id=user_id))
    
    if is_super_admin:
        kb.button(text="๐ ะะฐะฑะปะพะบะธัะพะฒะฐัั", callback_data=UsersAction(action="block", user_id=user_id))
        kb.button(text="โ ะะฐะทะฑะปะพะบะธัะพะฒะฐัั", callback_data=UsersAction(action="unblock", user_id=user_id))
        kb.button(text="๐ ะกัะฐัะธััะธะบะฐ", callback_data=UsersAction(action="stats", user_id=user_id))
    
    # ะฃะปัััะตะฝะฝะฐั ะฝะฐะฒะธะณะฐัะธั
    kb.button(text="๐ ะะปะฐะฒะฝะพะต", callback_data=AdminMenuAction(action="main"))
    kb.button(text="๐ฅ ะกะฟะธัะพะบ", callback_data=UsersAction(action="list", page=1))
    kb.button(text="๐ ะะฐะทะฐะด", callback_data="context_back")
    
    kb.adjust(2, 2, 2, 3)
    return kb.as_markup()
```

### 4. ะะธะทัะฐะปัะฝะฐั ะพะฑัะฐัะฝะฐั ัะฒัะทั

ะะพะฑะฐะฒะธัั ะธะฝะดะธะบะฐัะพัั ะทะฐะณััะทะบะธ ะธ ะฟะพะดัะฒะตัะถะดะตะฝะธั ะดะตะนััะฒะธะน:

```python
# ะัะธ ะฒัะฟะพะปะฝะตะฝะธะธ ะดะปะธัะตะปัะฝัั ะพะฟะตัะฐัะธะน
await call.message.edit_text("โณ ะะฑัะฐะฑะพัะบะฐ ะทะฐะฟัะพัะฐ...")

# ะะพัะปะต ััะฟะตัะฝะพะณะพ ะฒัะฟะพะปะฝะตะฝะธั ะดะตะนััะฒะธั
await call.message.edit_text("โ ะะตะนััะฒะธะต ััะฟะตัะฝะพ ะฒัะฟะพะปะฝะตะฝะพ!", reply_markup=updated_keyboard)

# ะะปั ะบัะธัะธัะตัะบะธั ะดะตะนััะฒะธะน - ะพะฑัะทะฐัะตะปัะฝะพะต ะฟะพะดัะฒะตัะถะดะตะฝะธะต
await call.message.edit_text("โ๏ธ ะั ัะฒะตัะตะฝั, ััะพ ัะพัะธัะต ะฒัะฟะพะปะฝะธัั ััะพ ะดะตะนััะฒะธะต?", 
                           reply_markup=confirmation_keyboard)
```

## ะขะตัะฝะธัะตัะบะธะต ัะตะบะพะผะตะฝะดะฐัะธะธ

### 1. ะะฑะฝะพะฒะปะตะฝะธะต ััััะบัััั callback data

ะะปั ัะตะฐะปะธะทะฐัะธะธ ัะปัััะตะฝะฝะพะน ะฝะฐะฒะธะณะฐัะธะธ ัะตะบะพะผะตะฝะดัะตััั ัะฐััะธัะธัั ัััะตััะฒััััั ัะธััะตะผั callback data:

```python
class EnhancedNavigationAction(CallbackData, prefix="enh_nav"):
    action: str  # "back", "main", "to_section", "refresh", "contextual_back"
    section: str = ""  # ัะตะปะตะฒะพะน ัะฐะทะดะตะป
    context_stack: str = ""  # ัะตัะธะฐะปะธะทะพะฒะฐะฝะฝัะน ััะตะบ ะบะพะฝัะตะบััะฐ
    page: int = 1  # ัะตะบััะฐั ัััะฐะฝะธัะฐ ะดะปั ัะฐะทะดะตะปะพะฒ ั ะฟะฐะณะธะฝะฐัะธะตะน
```

### 2. ะะตะฐะปะธะทะฐัะธั ัะธััะตะผั ะบะพะฝัะตะบััะฐ

ะกะพะทะดะฐัั ัะตัะฒะธั ะดะปั ัะฟัะฐะฒะปะตะฝะธั ะบะพะฝัะตะบััะพะผ ะฝะฐะฒะธะณะฐัะธะธ:

```python
class NavigationContext:
    def __init__(self, state: FSMContext):
        self.state = state
    
    async def push_context(self, context: str):
        """ะะพะฑะฐะฒะธัั ะบะพะฝัะตะบัั ะฒ ััะตะบ"""
        data = await self.state.get_data()
        context_stack = data.get("context_stack", [])
        context_stack.append(context)
        await self.state.update_data(context_stack=context_stack)
    
    async def pop_context(self):
        """ะะทะฒะปะตัั ะฟะพัะปะตะดะฝะธะน ะบะพะฝัะตะบัั ะธะท ััะตะบะฐ"""
        data = await self.state.get_data()
        context_stack = data.get("context_stack", [])
        if context_stack:
            return context_stack.pop()
        return None
    
    async def get_current_context(self):
        """ะะพะปััะธัั ัะตะบััะธะน ะบะพะฝัะตะบัั"""
        data = await self.state.get_data()
        context_stack = data.get("context_stack", [])
        return context_stack[-1] if context_stack else "main"
```

### 3. ะฃะปัััะตะฝะฝัะต ะบะปะฐะฒะธะฐัััั

ะะฑะฝะพะฒะธัั ัะฐะฑัะธะบั ะบะปะฐะฒะธะฐััั ะดะปั ะฟะพะดะดะตัะถะบะธ ะฝะพะฒัั ััะฝะบัะธะน:

```python
class AdminKeyboardFactory:
    # ... ัััะตััะฒัััะธะต ะผะตัะพะดั ...
    
    @staticmethod
    def create_enhanced_user_list(users: List[User], current_page: int, total_pages: int, context: str = "main"):
        """ะกะพะทะดะฐะฝะธะต ัะปัััะตะฝะฝะพะน ะบะปะฐะฒะธะฐัััั ัะฟะธัะบะฐ ะฟะพะปัะทะพะฒะฐัะตะปะตะน ั ะธะฝะปะฐะนะฝ-ะบะฝะพะฟะบะฐะผะธ"""
        kb = InlineKeyboardBuilder()
        
        # ะะพะฑะฐะฒะปัะตะผ ะฟะพะปัะทะพะฒะฐัะตะปะตะน ะฒ ะฒะธะดะต ะธะฝะปะฐะนะฝ-ะบะฝะพะฟะพะบ
        for user in users:
            premium_emoji = "โญ" if user.is_premium else "๐ค"
            username = f"@{user.username}" if user.username else str(user.user_id)
            kb.button(
                text=f"{premium_emoji} {username}",
                callback_data=UsersAction(action="manage", user_id=user.user_id)
            )
        
        # ะะพะฑะฐะฒะปัะตะผ ะฟะฐะณะธะฝะฐัะธั
        kb.adjust(1)  # ะพะดะฝะฐ ะบะฝะพะฟะบะฐ ะฒ ััะดั ะดะปั ัะดะพะฑััะฒะฐ
        
        # ะะฝะพะฟะบะธ ะฝะฐะฒะธะณะฐัะธะธ
        nav_kb = InlineKeyboardBuilder()
        if current_page > 1:
            nav_kb.button(text="โฌ๏ธ", callback_data=PaginationAction(action="prev", page=current_page-1))
        nav_kb.button(text=f"{current_page}/{total_pages}", callback_data="noop")
        if current_page < total_pages:
            nav_kb.button(text="โก๏ธ", callback_data=PaginationAction(action="next", page=current_page+1))
        
        # ะะพะฝัะตะบััะฝะฐั ะฝะฐะฒะธะณะฐัะธั
        context_kb = InlineKeyboardBuilder()
        context_kb.button(text="๐ ะะปะฐะฒะฝะพะต", callback_data=AdminMenuAction(action="main"))
        context_kb.button(text="๐ ะะฐะทะฐะด", callback_data=EnhancedNavigationAction(action="contextual_back", context=context))
        
        # ะะพะผะฑะธะฝะธััะตะผ ะฒัะต ะบะปะฐะฒะธะฐัััั
        combined_kb = InlineKeyboardBuilder()
        combined_kb.attach(kb)
        combined_kb.attach(nav_kb)
        combined_kb.attach(context_kb)
        
        return combined_kb.as_markup()
```

## ะะฐะบะปััะตะฝะธะต

ะัะตะดะปะพะถะตะฝะฝัะต ัะปัััะตะฝะธั ะฟะพะทะฒะพะปัั ะทะฝะฐัะธัะตะปัะฝะพ ะฟะพะฒััะธัั ัะดะพะฑััะฒะพ ะธัะฟะพะปัะทะพะฒะฐะฝะธั ะฐะดะผะธะฝ-ะฟะฐะฝะตะปะธ ะธ ัััะตะบัะธะฒะฝะพััั ะฐะดะผะธะฝะธัััะฐัะธะฒะฝัั ะทะฐะดะฐั. ะะปััะตะฒัะผะธ ะฝะฐะฟัะฐะฒะปะตะฝะธัะผะธ ัะฒะปััััั:

1. ะะฝะตะดัะตะฝะธะต ัะธััะตะผั ะบะพะฝัะตะบััะฝะพ-ะทะฐะฒะธัะธะผะพะน ะฝะฐะฒะธะณะฐัะธะธ
2. ะกะพะทะดะฐะฝะธะต ะฑะพะปะตะต ะธะฝัะตัะฐะบัะธะฒะฝัั ะธ ะธะฝัะพัะผะฐัะธะฒะฝัั ะธะฝัะตััะตะนัะพะฒ
3. ะฃะปัััะตะฝะธะต UX ะฟัะธ ัะฟัะฐะฒะปะตะฝะธะธ ะฟะพะปัะทะพะฒะฐัะตะปัะผะธ ะธ ัะพะทัะณัััะฐะผะธ
4. ะะพะฑะฐะฒะปะตะฝะธะต ะฒะธะทัะฐะปัะฝะพะน ะพะฑัะฐัะฝะพะน ัะฒัะทะธ ะธ ะฟะพะดัะฒะตัะถะดะตะฝะธะน ะดะตะนััะฒะธะน

ะะตะฐะปะธะทะฐัะธั ััะธั ัะปัััะตะฝะธะน ะฟะพััะตะฑัะตั ะฟะพััะฐะฟะฝะพะณะพ ะฟะพะดัะพะดะฐ, ะฝะฐัะธะฝะฐั ั ะพะฑะฝะพะฒะปะตะฝะธั callback data ะธ ัะฐะฑัะธะบะธ ะบะปะฐะฒะธะฐััั, ะทะฐัะตะผ ะฟะพััะตะฟะตะฝะฝะพะณะพ ะฒะฝะตะดัะตะฝะธั ะฝะพะฒัั ะธะฝัะตััะตะนัะพะฒ ะฒ ะบะฐะถะดะพะผ ัะฐะทะดะตะปะต ะฐะดะผะธะฝ-ะฟะฐะฝะตะปะธ.